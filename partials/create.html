<script type="text/ng-template" id="btns.html">
	<button ng-click="add(node.nodes, 'if', 'se')" class="btn">Condição</button>
    <button ng-click="add(node.nodes, 'write', 'escrever')" class="btn">Escrever</button>
    <button ng-click="add(node.nodes, 'for', 'for')" class="btn">Repetir</button>
    <button ng-click="add(node.nodes, 'attr', 'attr')" class="btn">Atribuição</button>
</script>

<script type="text/ng-template"  id="nodes.html">
	<ul ui:sortable="sortableOptions" ng:model="node.nodes">
        <li ng-repeat="node in node.nodes" ng-include="getTemplate(node)"></li>
    </ul>
</script>

<script type="text/ng-template"  id="tree_item_renderer.html">
    {{node.name}} {{node.type}}
    <button ng-click="delete(node)" ng-show="node.nodes.length > 0" class="btn">Limpar</button>
    <span ng-include="'nodes.html'"></span>
    <span ng-include="btns.html"></span>
</script>

<script type="text/ng-template"  id="start.html">
    {{node.name}} {{node.type}}
    <button ng-click="delete(node)" ng-show="node.nodes.length > 0" class="btn">Limpar</button>
    <span ng-include="'nodes.html'"></span>
    <span ng-include="'btns.html'"></span>
</script>

<script type="text/ng-template"  id="for.html">
    <div class="repeat">
        <div class="handle"><i class="icon-sort"></i></div>
        {{node.name}} <span edit-in-place='node.times'></span> vezes.
        <button class="btn pull-right" ng-click="removeItem(node.parent, node)"><i class="icon icon-trash"></i></button>
        <button ng-click="delete(node)" ng-show="node.nodes.length > 0" class="btn">Limpar</button>
        <span ng-include="'nodes.html'"></span>
        <span ng-include="'btns.html'"></span>
    </div>
</script> 
<script type="text/ng-template"  id="if.html">
    {{node.name}} 
                    <select ng-model='teste'>
                        <option ng-repeat="var in programs[currentProgram].functions[0].vars">{{var.name}}</option>
                    </select> igual <input type="text" value="VAR">
    <button class="btn pull-right" ng-click="removeItem(node.parent, node)"><i class="icon icon-trash"></i></button>
    <button ng-click="delete(node)" ng-show="node.nodes.length > 0" class="btn">Limpar</button>
    <span ng-include="'nodes.html'"></span>
    <span ng-include="'btns.html'"></span>

</script>
<script type="text/ng-template"  id="write.html">
    <div class="write">
    <div class="handle"><i class="icon-sort"></i></div>
        {{node.name}}
        <button class="btn pull-right" ng-click="removeItem(node.parent, node)"><i class="icon icon-trash"></i></button>
        (<span select-variable="node.variable" select-model="node.variable" select-vars="programs[currentProgram].functions[0].vars"></span>)
        
        <span class="badge badge-important pull-right" ng-show="node.variable==''"><i class="icon icon-exclamation"></i></span>
    </div>  
</script>

<script type="text/ng-template"  id="var.html">
    <i>{{node.name}}</i> <span edit-in-place='node.data.varName'></span> = <input type="text" value="VAR"> {{node.data.varName}}
</script>

<script type="text/ng-template"  id="attr_var_exp.html">
    <span ng-show="ex.t=='exp'">
        (<span ng-repeat="ex in ex.exp" ng-include="'attr_var_exp.html'"></span> <span class="dropdown">
            <button class="btn btn-mini" data-toggle="dropdown"><i class="icon icon-align-justify"></i></button>
            <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                <li><a role="menuitem" ng-click="addElVar(ex.exp)">Variável</a></li>
                <li><a role="menuitem" ng-click="addElVal(ex.exp)">Valor</a></li>
            </ul>
    </span>)
    </span>
    <span ng-show="ex.t=='val'">
        <span edit-in-place-value="ex.v"></span>
    </span>
    <span ng-show="ex.t=='var'">
        <span select-variable-boot="ex.v" ex="ex" select-model="ex.v" select-vars="programs[currentProgram].functions[0].vars"></span>
    </span>
    <span ng-hide="$last">&nbsp;<span select-operator="ex.o" ex="ex" select-model="ex.v" select-vars="programs[currentProgram].functions[0].vars"></span>&nbsp;</span>
</script>

<script type="text/ng-template"  id="attr.html">
    <div class="attr">
    <div class="handle"><i class="icon-sort"></i></div>
    <button class="btn pull-right" ng-click="removeItem(node.parent, node)"><i class="icon icon-trash"></i></button>
    <span select-variable="node.variable" select-model="node.variable" select-vars="programs[currentProgram].functions[0].vars"></span> recebe   
            <span edit-in-place="node.value"></span>
            <span ng-repeat="ex in node.exp">
                <span ng-include="'attr_var_exp.html'"></span>
            </span>
            <span class="dropdown">
                    <button class="btn btn-mini" data-toggle="dropdown"><i class="icon icon-align-justify"></i></button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                        <li><a role="menuitem" ng-click="addElVar(node.exp)">Variável</a></li>
                        <li><a role="menuitem" ng-click="addElVal(node.exp)">Valor</a></li>
                    </ul>
            </span>

    </div>
    <span class="badge badge-important pull-right" ng-show="isValidAttr(node.exp)"><i class="icon icon-exclamation"></i></span>
</script>


<div class="container">
    <ul class="nav nav-tabs">
        <li class="dropdown" ng-repeat="program in programs">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">{{program.programName}} <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li ng-repeat="func in program.functions"><a href="#dropdown1" data-toggle="tab">{{func.name}}</a></li>
              <li><a href="#dropdown1" data-toggle="tab">create a function</a></li>
              <li><a href="#dropdown1" data-toggle="tab">create a method</a></li>
            </ul>
        </li>
    </ul>
    <div class="row-fluid" ng-repeat="prog in programs">
        <div class="span6">
            <div class="ivprog" ng-repeat="func in prog.functions">
                <div class="parameters">
                    <h5><i class="icon icon-th-list" style="font-size: 14px;"></i> Parâmetros <button class="btn" ng-click="addParam()"><i class="icon icon-plus"></i></button></h5>
                    <span class="var" ng-repeat="param in func.params">&nbsp;<span edit-in-place='param.name'></span> = <span edit-in-place='param.initialValue'></span> <span edit-in-place="param.opa" /> <button class="btn btn-mini" ng-click="removeParam(var)"><i class="icon icon-remove"></i></button></span>
                    <span class="clearfix"></span>
                </div>
                <div class="variables">
                    <h5><i class="icon icon-th-list" style="font-size: 14px;"></i> Variáveis locais <button class="btn" ng-click="addVar()"><i class="icon icon-plus"></i></button></h5>
                    <span class="var" ng-repeat="var in func.vars">&nbsp;<span edit-in-place-var-name='var.name'></span> = <span edit-in-place='var.initialValue'></span> <div class="btn-group"><button class="btn btn-mini" ng-click="configVar(var)"><i class="icon icon-wrench"></i></button><button class="btn btn-mini" ng-click="removeVar(var)"><i class="icon icon-remove"></i></button></div></span>
                    <span class="clearfix"></span>
                </div>
                
                <ul ui:sortable="sortableOptions" ng:model="programs[currentProgram].functions[0].nodes">
                    <li ng-repeat="node in programs[currentProgram].functions[0].nodes" ng-include="getTemplate(node)" ng-animate=" 'animate' ">
                    </li>
                </ul>
                <div class="addButtons">
                    <button class="btn" onclick="$('#addBtns1').fadeToggle();"><i class="icon icon-plus"></i></button>
                    <div class="btn-group hide" id="addBtns1">
                        <button ng-click="add(programs[currentProgram].functions[0].nodes, 'if', 'se')" class="btn">Condição</button>
                        <button ng-click="add(programs[currentProgram].functions[0].nodes, 'read', 'ler')" class="btn">Ler</button>
                        <button ng-click="add(programs[currentProgram].functions[0].nodes, 'write', 'escrever')" class="btn">Escrever</button>
                        <button ng-click="add(programs[currentProgram].functions[0].nodes, 'for', 'repetir')" class="btn">Repetir</button>
                        <button ng-click="add(programs[currentProgram].functions[0].nodes, 'attr', 'attr')" class="btn">Atribuição</button>
                    </div>
                </div>

            </div>
        </div>
        <div class="span6">
            <h4>Source</h4>
            <div class="source">
                <span class="comment">// seu programa em código C</span><br />
                <div class="variables">
                    <i ng-hide="programs[currentProgram].functions[0].vars.length==0">var</i><span ng-show="vars.length>1">;</span> <span class="var" ng-repeat="var in programs[currentProgram].functions[0].vars"> <b>{{var.name}}</b> : {{var.type}} = {{var.initialValue}}<span ng-hide="$last">,</span><span ng-show="$last">;</span></span>
                </div>
            </div>
            <h4>Output</h4>
            <div class="btn-group"><button class="btn" ng-click="run()"><i class="icon icon-play"></i></button><button class="btn" ng-click="clearOutput()">Clear</button></div>
            <div class="output">

            </div>
        </div>
    </div>
</div>

